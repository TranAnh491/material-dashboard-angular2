<div class="main-content">
  <!-- Excel-like Container -->
  <div class="excel-container">
    <!-- Report Title -->
    <div class="excel-header">
      <h4>üì¶ INVENTORY ASM2</h4>
      <!-- Consolidation Status Message -->
      <div class="consolidation-message" *ngIf="showConsolidationMessage" [class.success]="consolidationMessage.includes('‚úÖ')" [class.info]="consolidationMessage.includes('‚ÑπÔ∏è')">
        <i class="material-icons">{{consolidationMessage.includes('‚úÖ') ? 'check_circle' : 'info'}}</i>
        <span>{{ consolidationMessage }}</span>
        <button class="close-message" (click)="showConsolidationMessage = false">
          <i class="material-icons">close</i>
        </button>
      </div>
      <!-- Catalog Loading Indicator -->
      <div class="catalog-status" *ngIf="isCatalogLoading">
        <i class="material-icons rotating">sync</i>
        <span>ƒêang t·∫£i danh m·ª•c h√†ng h√≥a...</span>
      </div>
    </div>
    
    <!-- Excel Actions -->
    <div class="excel-actions">
      <div class="action-controls-horizontal">
        <!-- More Button - Opens Popup -->
        <button class="more-btn" (click)="openMorePopup()">
          <i class="material-icons">more_vert</i>
          More
        </button>
        
        <!-- Negative Stock Counter Box -->
        <div class="negative-stock-counter-box" 
             *ngIf="(negativeStockCount$ | async) > 0"
             [title]="'C√≥ ' + (negativeStockCount$ | async) + ' m√£ h√†ng c√≥ t·ªìn kho √¢m'">
          <i class="material-icons">warning</i>
          <span>M√£ √¢m: {{ (negativeStockCount$ | async) }}</span>
        </div>
        
        <!-- Total Counter Box -->
        <div class="total-counter-box clickable" 
             (click)="toggleNegativeStockFilter()"
             [class.active-filter]="showOnlyNegativeStock"
             [title]="showOnlyNegativeStock ? 'Click ƒë·ªÉ hi·ªÉn th·ªã t·∫•t c·∫£' : 'Click ƒë·ªÉ ch·ªâ hi·ªÉn th·ªã m√£ √¢m'">
          <i class="material-icons">inventory_2</i>
          <span>T·ªïng: {{ filteredInventory.length }} m√£</span>
        </div>
        
        <!-- Total Stock Counter Box -->
        <div class="total-stock-counter-box">
          <i class="material-icons">assessment</i>
          <span>T·ªïng t·ªìn: {{ (totalStockCount$ | async) | number:'1.0-0' }}</span>
        </div>
        
        <!-- Search Type Selector -->
        <button class="search-type-btn" 
                (click)="cycleSearchType()"
                [title]="'T√¨m theo: ' + (searchType === 'material' ? 'M√£ h√†ng' : searchType === 'po' ? 'PO' : 'V·ªã tr√≠')">
          <i class="material-icons">{{searchType === 'material' ? 'inventory' : searchType === 'po' ? 'receipt' : 'place'}}</i>
          {{searchType === 'material' ? 'M√£' : searchType === 'po' ? 'PO' : 'V·ªã tr√≠'}}
        </button>
        
        <!-- Search Box -->
        <input type="text"
               [placeholder]="'T√¨m ki·∫øm...'"
               [(ngModel)]="searchTerm"
               (input)="onSearchInput($event)"
               class="search-input"
               [disabled]="isLoading">
        
        <button class="clear-search-btn" 
                *ngIf="searchTerm" 
                (click)="clearSearch()" 
                title="X√≥a">
          <i class="material-icons">clear</i>
        </button>
        
        <!-- Reset Button -->
        <button class="reset-btn" (click)="resetZeroStock()" title="X√≥a h√†ng t·ªìn = 0">
          <i class="material-icons">restart_alt</i>
          Reset
        </button>
        
        <!-- Catalog Ready Icon -->
        <div class="catalog-ready-icon" *ngIf="!isCatalogLoading && catalogLoaded">
          <i class="material-icons">check_circle</i>
        </div>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-container" *ngIf="isLoading">
      <div class="loading-spinner">
        <i class="material-icons rotating">sync</i>
        <span>ƒêang t·∫£i d·ªØ li·ªáu ASM2...</span>
        <!-- üöÄ OPTIMIZATION: Add progress bar for search -->
        <div class="search-progress" *ngIf="isSearching">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="searchProgress"></div>
          </div>
          <span class="progress-text">{{searchProgress}}%</span>
        </div>
      </div>
    </div>



    <!-- Mobile Card View -->
    <div class="mobile-cards-container" *ngIf="!isLoading">
      <div class="mobile-card" *ngFor="let material of displayedInventory; trackBy: trackByFn; let i = index" 
           [class.duplicate-card]="material.isDuplicate"
           [class.iqc-card]="isIQCLocation(material.location)">
        
        <!-- Card Header -->
        <div class="card-header">
          <div class="material-info">
            <h3 class="material-code">{{material.materialCode}}</h3>
            <p class="po-number">PO: {{material.poNumber}}</p>
          </div>
          <div class="card-actions">
            <button class="qr-btn" 
                    (click)="printQRCode(material)"
                    [disabled]="!isRollsOrBagsValid(material)"
                    [title]="!isRollsOrBagsValid(material) ? 'Kh√¥ng th·ªÉ in QR - thi·∫øu Rolls/Bags' : 'T·∫°o QR code'">
              <i class="material-icons">qr_code</i>
            </button>
          </div>
        </div>
        
        <!-- Card Content -->
        <div class="card-content">
          <div class="info-row">
            <span class="label">IMD:</span>
            <span class="value">{{getDisplayIMD(material)}}</span>
          </div>
          
          <div class="info-row">
            <span class="label">T·ªìn ƒë·∫ßu:</span>
            <input type="number" 
                   class="mobile-input" 
                   [ngModel]="material.openingStock || ''"
                   (ngModelChange)="material.openingStock = $event === '' ? null : +$event" 
                   (change)="updateOpeningStock(material)" 
                   min="0" 
                   step="0.1" 
                   placeholder="Nh·∫≠p t·ªìn ƒë·∫ßu">
          </div>
          
          <div class="info-row">
            <span class="label">NK:</span>
            <span class="value">{{formatNumber(material.quantity)}}</span>
          </div>
          
          <div class="info-row">
            <span class="label">ƒê√£ xu·∫•t:</span>
            <span class="value">{{formatNumber(material.exported || 0)}}</span>
          </div>
          
          <div class="info-row">
            <span class="label">XT:</span>
            <input type="number" 
                   class="mobile-input" 
                   [(ngModel)]="material.xt" 
                   (change)="updateXT(material)" 
                   min="0" 
                   step="0.1" 
                   placeholder="Nh·∫≠p XT">
          </div>
          
          <div class="info-row">
            <span class="label">T·ªìn kho:</span>
            <span class="value" [class.negative-stock]="calculateCurrentStock(material) < 0">
              {{formatNumber(calculateCurrentStock(material))}}
            </span>
          </div>
          
          <div class="info-row location-row">
            <span class="label">V·ªã tr√≠:</span>
            <div style="display: flex; align-items: center; gap: 8px;">
              <input type="text" 
                     class="mobile-input location-input" 
                     [(ngModel)]="material.location" 
                     (change)="updateLocation(material)"
                     (blur)="onLocationChange(material)"
                     placeholder="Nh·∫≠p v·ªã tr√≠">
              <button class="scan-btn" 
                      (click)="scanLocationQR(material)"
                      title="Scan QR ƒë·ªÉ thay ƒë·ªïi v·ªã tr√≠">
                <i class="material-icons">qr_code_scanner</i>
              </button>
            </div>
          </div>
          
          <div class="info-row">
            <span class="label">QTY BAG:</span>
            <input type="number" 
                   class="mobile-input" 
                   [(ngModel)]="material.rollsOrBags" 
                   (change)="updateRollsOrBags(material)"
                   min="0" 
                   step="1"
                   [placeholder]="getStandardPacking(material.materialCode) || '0'">
          </div>
          
          <div class="info-row">
            <span class="label">Standard Packing:</span>
            <span class="value">{{ getStandardPacking(material.materialCode) }}</span>
          </div>
        </div>
        
        <!-- Card Footer -->
        <div class="card-footer">
          <div class="status-badge" [class]="getStatusClass(material)">
            {{ getStatusText(material) }}
          </div>
          <button class="delete-btn" 
                  *ngIf="canDelete"
                  (click)="deleteInventoryItem(material)"
                  title="X√≥a item n√†y">
            <i class="material-icons">delete</i>
          </button>
        </div>
      </div>
      
      <!-- Mobile Pagination -->
      <div class="pagination-container mobile-only" *ngIf="totalPages > 1">
        <div class="pagination-info">
          Trang {{currentPage}} / {{totalPages}} - {{displayedInventory.length}} / {{filteredInventory.length}} m√£
        </div>
        <div class="pagination-controls">
          <button class="page-btn" (click)="previousPage()" [disabled]="currentPage <= 1">
            <i class="material-icons">chevron_left</i>
          </button>
          <select class="page-selector" [(ngModel)]="currentPage" (change)="goToPage(currentPage)">
            <option *ngFor="let page of [].constructor(totalPages); let i = index" [value]="i + 1">
              {{i + 1}}
            </option>
          </select>
          <button class="page-btn" (click)="nextPage()" [disabled]="currentPage >= totalPages">
            <i class="material-icons">chevron_right</i>
          </button>
        </div>
      </div>
    </div>

    <!-- Desktop Table Container -->
    <div class="table-container desktop-only" *ngIf="!isLoading">
      <!-- Table -->
      <table class="excel-table">
        <thead>
          <tr>
            <th>QR</th>
            <th>QTY BAG</th>
            <th>STT</th>

            <th>M√£ h√†ng</th>
            <th>PO</th>
                            <th>IMD</th>
            <th>T·ªìn ƒë·∫ßu</th>
            <th>NK</th>
            <th title="S·ªë l∆∞·ª£ng ƒë√£ xu·∫•t t·ª´ RM1 outbound (t·ª± ƒë·ªông c·∫≠p nh·∫≠t)">ƒê√£ xu·∫•t</th>
            <th title="S·ªë l∆∞·ª£ng c·∫ßn xu·∫•t (nh·∫≠p tay)">XT</th>
            <th title="T·ªìn kho = T·ªìn ƒë·∫ßu + NK - ƒê√£ xu·∫•t - XT">T·ªìn kho</th>
            <th>V·ªã tr√≠</th>
            <th>Change</th>
            <th>Lo·∫°i H√¨nh</th>

            <th>L∆∞u √Ω</th>
            <th>Standard Packing</th>
            <th>Tr·∫°ng th√°i</th>
            <th>IQC Status</th>
            <th>X√≥a</th>
            <th>Factory</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let material of displayedInventory; trackBy: trackByFn; let i = index" 
              [class.duplicate-row]="material.isDuplicate"
              [class.iqc-row]="isIQCLocation(material.location)">
            <td class="qr-cell">
              <button class="qr-btn" 
                      (click)="printQRCode(material)"
                      [disabled]="!isRollsOrBagsValid(material)"
                      [title]="!isRollsOrBagsValid(material) ? 'Kh√¥ng th·ªÉ in QR - thi·∫øu Rolls/Bags' : 'T·∫°o QR code'">
                <i class="material-icons">qr_code</i>
              </button>
            </td>
            <td class="rolls-bags-cell">
              <input type="number" 
                     class="editable-input" 
                     [(ngModel)]="material.rollsOrBags" 
                     (change)="updateRollsOrBags(material)"
                     (blur)="updateRollsOrBags(material)"
                     (keyup.enter)="updateRollsOrBags(material)"
                     min="0" 
                     step="1"
                     [placeholder]="getStandardPacking(material.materialCode) || '0'"
                     [title]="'QTY BAG (m·∫∑c ƒë·ªãnh t·ª´ Standard Packing: ' + (getStandardPacking(material.materialCode) || 'N/A') + ')'">
            </td>
            <td class="row-header">{{i + 1}}</td>

            <td class="code-cell material-code-cell" 
                [class.duplicate-cell]="material.isDuplicate"
                [class.duplicate-code]="material.isDuplicate"
                [class.normal-code]="!material.isDuplicate">
              {{material.materialCode}}
            </td>
            <td class="po-cell" [class.duplicate-cell]="material.isDuplicate">{{material.poNumber}}</td>
            <td class="date-cell" [class.duplicate-cell]="material.isDuplicate">
              {{getDisplayIMD(material)}}
            </td>
            <td class="number-cell" [class.duplicate-cell]="material.isDuplicate">
              <span *ngIf="!material.isEditingOpeningStock" 
                    class="display-value" 
                    (click)="startEditingOpeningStock(material)"
                    [title]="'Click ƒë·ªÉ s·ª≠a t·ªìn ƒë·∫ßu: ' + formatNumber(material.openingStock || 0)">
                {{formatNumber(material.openingStock || 0)}}
              </span>
              <input *ngIf="material.isEditingOpeningStock"
                     type="number" 
                     class="opening-stock-input" 
                     [ngModel]="material.openingStock || ''"
                     (ngModelChange)="material.openingStock = $event === '' ? null : +$event" 
                     (blur)="finishEditingOpeningStock(material)"
                     (keyup.enter)="finishEditingOpeningStock(material)"
                     (keyup.escape)="cancelEditingOpeningStock(material)"
                     min="0" 
                     step="0.1" 
                     placeholder="Nh·∫≠p t·ªìn ƒë·∫ßu">
            </td>
            <td class="number-cell" [class.duplicate-cell]="material.isDuplicate">{{formatNumber(material.quantity)}}</td>
            <!-- C·ªôt "ƒê√£ xu·∫•t" - C√≥ th·ªÉ edit khi m·ªü kh√≥a -->
            <td class="number-cell" 
                [class.readonly-cell]="!isExportColumnUnlocked"
                [class.editable-export-cell]="isExportColumnUnlocked"
                [title]="isExportColumnUnlocked ? 'Click ƒë·ªÉ s·ª≠a s·ªë l∆∞·ª£ng ƒë√£ xu·∫•t' : 'S·ªë l∆∞·ª£ng ƒë√£ xu·∫•t t·ª´ RM1 outbound: ' + (material.exported || 0) + '\nT·ª± ƒë·ªông c·∫≠p nh·∫≠t v√† l∆∞u tr·ªØ vƒ©nh vi·ªÖn\nK·ªÉ c·∫£ khi x√≥a d√≤ng xu·∫•t ·ªü outbound c≈©ng kh√¥ng ·∫£nh h∆∞·ªüng'">
              <ng-container *ngIf="!isExportColumnUnlocked">
                {{formatNumber(material.exported || 0)}}
              </ng-container>
              <ng-container *ngIf="isExportColumnUnlocked">
                <input type="number" 
                       class="editable-input" 
                       [(ngModel)]="material.exported"
                       (change)="updateExportedAmount(material)"
                       (blur)="updateExportedAmount(material)"
                       (keyup.enter)="updateExportedAmount(material)"
                       min="0" 
                       step="0.1"
                       placeholder="0">
              </ng-container>
            </td>
                        <!-- C·ªôt "XT" - S·ªë l∆∞·ª£ng c·∫ßn xu·∫•t (nh·∫≠p tay) -->
            <td class="number-cell xt-column">
              <span *ngIf="!material.isEditingXT" 
                    class="display-value" 
                    (click)="startEditingXT(material)"
                    [title]="'Click ƒë·ªÉ s·ª≠a XT: ' + formatNumber(material.xt || 0)">
                {{formatNumber(material.xt || 0)}}
              </span>
              <input *ngIf="material.isEditingXT"
                     type="number" 
                     class="editable-cell" 
                     [ngModel]="material.xt || ''"
                     (ngModelChange)="material.xt = $event === '' ? null : +$event" 
                     (blur)="finishEditingXT(material)"
                     (keyup.enter)="finishEditingXT(material)"
                     (keyup.escape)="cancelEditingXT(material)"
                     min="0" 
                     step="0.1" 
                     placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng XT">
            </td>
            <td class="number-cell" [class.duplicate-cell]="material.isDuplicate" 
                [class.negative-stock-cell]="calculateCurrentStock(material) < 0"
                [title]="'L∆∞·ª£ng nh·∫≠p: ' + (material.quantity || 0) + ' - Xu·∫•t: ' + (material.exported || 0) + ' - XT: ' + (material.xt || 0) + ' = ' + calculateCurrentStock(material)">
              {{formatNumber(calculateCurrentStock(material))}}
            </td>
            <td class="location-cell" [class.iqc-location]="isIQCLocation(material.location)">
              <input type="text" 
                     class="editable-cell location-input" 
                     [(ngModel)]="material.location" 
                     (change)="updateLocation(material)"
                     (blur)="onLocationChange(material)">
            </td>
            <td class="change-cell">
              <button class="scan-change-btn" 
                      (click)="scanLocationQR(material)"
                      title="Scan QR ƒë·ªÉ thay ƒë·ªïi v·ªã tr√≠">
                Scan
              </button>
            </td>
            <td class="type-cell">
              <input type="text" class="editable-cell" [(ngModel)]="material.type" (change)="updateType(material)">
            </td>

            <td class="notes-cell">
              <input type="text" 
                     class="editable-input" 
                     [(ngModel)]="material.remarks" 
                     (change)="updateRemarks(material)"
                     placeholder="Nh·∫≠p l∆∞u √Ω..."
                     title="L∆∞u √Ω t·ª´ inbound">
            </td>
            <td class="standard-packing-cell">
              <span class="standard-packing-value">{{ getStandardPacking(material.materialCode) }}</span>
            </td>
            <td class="status-cell">
              <span class="badge" 
                    [class]="getStatusClass(material)">
                {{ getStatusText(material) }}
              </span>
            </td>
            <td class="iqc-status-cell">
              <span class="badge" 
                    *ngIf="material.iqcStatus"
                    [class]="getIQCStatusClass(material)">
                {{ getIQCStatusText(material) }}
              </span>
              <span *ngIf="!material.iqcStatus" class="no-iqc-status">-</span>
            </td>
            <td class="delete-cell">
              <button class="delete-btn" 
                      *ngIf="canDelete"
                      (click)="deleteInventoryItem(material)"
                      title="X√≥a item n√†y kh·ªèi ASM2 Inventory">
                <i class="material-icons">delete</i>
              </button>
            </td>
            <td class="factory-cell factory-asm2">
              ASM2
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Empty State - Search First Approach -->
      <div class="empty-state" *ngIf="!searchTerm && filteredInventory.length === 0 && !isLoading">
        <div class="empty-state-content">
          <i class="material-icons">search</i>
          <h3>üîç T√¨m ki·∫øm ASM2 Inventory</h3>
          <p>Nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ t√¨m ki·∫øm materials trong ASM2 inventory</p>
          
          <!-- Search Suggestions -->
          <div class="search-suggestions">
            <h5>üí° G·ª£i √Ω t√¨m ki·∫øm:</h5>
            <div class="suggestion-tags">
              <span class="suggestion-tag" (click)="searchTerm = 'B018694'; onSearchInput({target: {value: 'B018694'}})">B018694</span>
              <span class="suggestion-tag" (click)="searchTerm = 'PO123'; onSearchInput({target: {value: 'PO123'}})">PO123</span>
              <span class="suggestion-tag" (click)="searchTerm = 'Location A'; onSearchInput({target: {value: 'Location A'}})">Location A</span>
            </div>
          </div>
          
          <!-- Quick Stats -->
          <div class="quick-stats">
            <div class="stat-item">
              <i class="material-icons">factory</i>
              <span>ASM2 Factory</span>
            </div>
            <div class="stat-item">
              <i class="material-icons">inventory</i>
              <span>Real-time Search</span>
            </div>
            <div class="stat-item">
              <i class="material-icons">speed</i>
              <span>Fast Loading</span>
            </div>
          </div>
        </div>
      </div>

      <!-- No Search Results -->
      <div class="no-results" *ngIf="searchTerm && filteredInventory.length === 0 && !isLoading">
        <div class="no-results-content">
          <i class="material-icons">search_off</i>
          <h4>üîç Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£</h4>
          <p>Kh√¥ng t√¨m th·∫•y materials n√†o cho "<strong>{{searchTerm}}</strong>" trong ASM2</p>
          
          <!-- Search Tips -->
          <div class="search-tips">
            <h6>üí° M·∫πo t√¨m ki·∫øm:</h6>
            <ul>
              <li>Ki·ªÉm tra ch√≠nh t·∫£</li>
              <li>Th·ª≠ t√¨m ki·∫øm v·ªõi √≠t k√Ω t·ª± h∆°n</li>
              <li>Ki·ªÉm tra factory filter (ASM2)</li>
              <li>Th·ª≠ t√¨m ki·∫øm theo PO number</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading-state" *ngIf="isLoading">
        <div class="loading-content">
          <i class="material-icons rotating">sync</i>
          <h4>üîç ƒêang t√¨m ki·∫øm...</h4>
          <p>T√¨m ki·∫øm "<strong>{{searchTerm}}</strong>" trong ASM2 inventory</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- More Options Popup -->
<div class="modal-overlay" *ngIf="showMorePopup" (click)="closeMorePopup()">
  <div class="modal-content more-popup-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>‚öôÔ∏è More Options</h3>
      <button class="close-btn" (click)="closeMorePopup()">
        <i class="material-icons">close</i>
      </button>
    </div>
    
    <div class="modal-body more-popup-body">
      <!-- Export/Import Section -->
      <div class="popup-section">
        <h4 class="popup-section-title">üì• Export/Import</h4>
        <div class="popup-actions">
          <button class="popup-action-btn" (click)="exportToExcel(); closeMorePopup()">
            <i class="material-icons">file_download</i>
            <span>Export to Excel</span>
          </button>
          <button class="popup-action-btn" (click)="downloadStockTemplate(); closeMorePopup()">
            <i class="material-icons">description</i>
            <span>Download Inventory Template</span>
          </button>
          <button class="popup-action-btn" (click)="importCurrentStock(); closeMorePopup()">
            <i class="material-icons">file_upload</i>
            <span>Import Inventory (T·ªìn ƒë·∫ßu)</span>
          </button>
          <button class="popup-action-btn" (click)="importCatalog(); closeMorePopup()">
            <i class="material-icons">file_upload</i>
            <span>Update Standard Packing</span>
          </button>
          <button class="popup-action-btn" (click)="loadStandardPacking(); closeMorePopup()">
            <i class="material-icons">file_download</i>
            <span>T·∫£i Standard Packing (Excel)</span>
          </button>
          <button class="popup-action-btn" (click)="downloadCatalogTemplate(); closeMorePopup()">
            <i class="material-icons">description</i>
            <span>Download Standard Packing Template</span>
          </button>
        </div>
      </div>
      
      <!-- Reports Section -->
      <div class="popup-section">
        <h4 class="popup-section-title">üìä Reports</h4>
        <div class="popup-actions">
          <button class="popup-action-btn" (click)="downloadFIFOReportASM2(); closeMorePopup()">
            <i class="material-icons">assessment</i>
            <span>Download FIFO Report ASM2</span>
          </button>
        </div>
      </div>
      
      <!-- Inventory Actions Section -->
      <div class="popup-section">
        <h4 class="popup-section-title">üì¶ Inventory Actions</h4>
        <div class="popup-actions">
          <button class="popup-action-btn" (click)="loadInventoryFromFirebase(); closeMorePopup()">
            <i class="material-icons">cloud_download</i>
            <span>Load to√†n b·ªô inventory</span>
          </button>
          <button class="popup-action-btn warning-action" (click)="consolidateAllInventory(); closeMorePopup()">
            <i class="material-icons">merge_type</i>
            <span>G·ªôp d√≤ng tr√πng l·∫∑p</span>
          </button>
          <button class="popup-action-btn delete-action" (click)="resetAllStock(); closeMorePopup()">
            <i class="material-icons">delete_forever</i>
            <span>Reset Stock (X√≥a to√†n b·ªô t·ªìn kho)</span>
          </button>
        </div>
      </div>
      
      <!-- Debug Section -->
      <div class="popup-section">
        <h4 class="popup-section-title">üêõ Debug Tools</h4>
        <div class="popup-actions">
          <button class="popup-action-btn" (click)="debugInventoryMatching(); closeMorePopup()">
            <i class="material-icons">bug_report</i>
            <span>Debug Inventory Matching</span>
          </button>
          <button class="popup-action-btn" (click)="testFIFOLogic('TEST001', 'PO001'); closeMorePopup()">
            <i class="material-icons">bug_report</i>
            <span>Test FIFO Logic</span>
          </button>
          <button class="popup-action-btn" (click)="testOutboundData(); closeMorePopup()">
            <i class="material-icons">bug_report</i>
            <span>Test Outbound Data</span>
          </button>
        </div>
      </div>
      
      <!-- Fix Section -->
      <div class="popup-section">
        <h4 class="popup-section-title">üîß Fix Tools</h4>
        <div class="popup-actions">
          <button class="popup-action-btn delete-action" (click)="fixProblematicBatchNumbers(); closeMorePopup()">
            <i class="material-icons">build</i>
            <span>S·ª≠a batchNumber l·ªói</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

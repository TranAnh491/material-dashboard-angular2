<div class="workorder-container">
  <h2 class="wo-title">Work Order Status</h2>
  <div class="edit-sheet-wrapper">
    <button class="edit-sheet-btn" (click)="openGoogleSheet()">
      <span style="display:flex;align-items:center;">
        <i class="material-icons" style="font-size:18px;margin-right:4px;">edit</i>
        Edit on Google Sheet
      </span>
    </button>
  </div>
  <div style="margin-bottom: 16px;">
    <label class="filter-label">Y:</label>
    <select [(ngModel)]="selectedYear" (change)="filterData()" style="margin-right:10px;">
      <option value="">-- Tất cả --</option>
      <option *ngFor="let y of years" [value]="y">{{y}}</option>
    </select>
    <label class="filter-label">M:</label>
    <select [(ngModel)]="selectedMonth" (change)="filterData()">
      <option value="">-- Tất cả --</option>
      <option *ngFor="let m of months" [value]="m">{{m}}</option>
    </select>
  </div>
  <!-- ... phần còn lại ... -->
  <table *ngIf="workOrders.length > 0" class="wo-table">
    <thead>
      <tr>
        <th *ngFor="let col of columns" [class.sticky]="isWorkOrder(col)">{{col}}</th>
        <th class="actions-col">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let row of workOrders; let i=index">
        <td *ngFor="let col of columns" [class.sticky]="isWorkOrder(col)">
          <ng-container *ngIf="editIndex === i; else viewOnly">
            <input [(ngModel)]="workOrders[i][col]" class="wo-input" (keydown.enter)="saveRow(i)" (blur)="saveRow(i)" />
          </ng-container>
          <ng-template #viewOnly>
            {{row[col]}}
          </ng-template>
        </td>
        <td class="actions-col">
          <button *ngIf="editIndex !== i" (click)="editIndex = i">Edit</button>
          <button *ngIf="editIndex === i" (click)="saveRow(i)">Save</button>
        </td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="loading">Loading...</div>
  <div *ngIf="errorMsg">{{errorMsg}}</div>
</div>

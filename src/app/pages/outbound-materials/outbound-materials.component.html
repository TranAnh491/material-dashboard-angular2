<div class="main-content">
  <!-- Excel-like Container -->
  <div class="excel-container">
    <!-- Excel-like Header -->
    <div class="excel-header">
      <h4>üì§ Outbound Materials</h4>
      <p>L·ªãch s·ª≠ xu·∫•t h√†ng t·ª´ kho</p>
    </div>

    <!-- Excel-like Actions -->
    <div class="excel-actions">
      <div class="search-box">
        <input type="text" 
               placeholder="T√¨m ki·∫øm..." 
               [(ngModel)]="searchTerm"
               (input)="onSearchChange($event)"
               class="search-input">
      </div>
      
      <div class="date-filters">
        <input type="date" 
               [(ngModel)]="startDate"
               (change)="applyDateRangeFilter()"
               class="date-input">
        <span>ƒë·∫øn</span>
        <input type="date" 
               [(ngModel)]="endDate"
               (change)="applyDateRangeFilter()"
               class="date-input">
      </div>
    </div>

    <!-- Excel-like Body -->
    <div class="excel-body">
      <table class="excel-table">
        <thead>
          <tr>
            <th class="row-header">#</th>
            <th>Ng√†y xu·∫•t</th>
            <th>M√£ h√†ng</th>
            <th>S·ªë P.O</th>
            <th>S·ªë l∆∞·ª£ng g·ªëc</th>
            <th>S·ªë l∆∞·ª£ng xu·∫•t</th>
            <th>V·ªã tr√≠</th>
            <th>Ph∆∞∆°ng th·ª©c</th>
            <th>Ng∆∞·ªùi xu·∫•t</th>
            <th>X√≥a</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let material of filteredOutbound; let i = index">
            <td class="row-header">{{i + 1}}</td>
            <td class="date-cell">{{material.exportDate | date:'dd/MM/yyyy HH:mm'}}</td>
            <td class="code-cell">{{material.materialCode}}</td>
            <td>{{material.poNumber}}</td>
            <td class="number-cell">{{material.quantity}}</td>
            <td class="number-cell">{{material.exportQuantity}}</td>
            <td>{{material.location}}</td>
            <td class="method-cell">
              <span class="badge" [class.badge-success]="material.scanMethod === 'QR_SCAN'" 
                    [class.badge-info]="!material.scanMethod || material.scanMethod === 'MANUAL'">
                {{material.scanMethod === 'QR_SCAN' ? 'QR Scan' : 'Manual'}}
              </span>
            </td>
            <td>{{material.exportedBy}}</td>
            <td class="status-cell">
              <button mat-icon-button color="warn" 
                      (click)="deleteOutboundRecord(material)"
                      matTooltip="X√≥a record n√†y">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- No Data Message -->
      <div class="no-data" *ngIf="filteredOutbound.length === 0">
        <i class="material-icons">inventory_2</i>
        <h5>Ch∆∞a c√≥ record xu·∫•t h√†ng</h5>
        <p>L·ªãch s·ª≠ xu·∫•t h√†ng s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y khi c√≥ ho·∫°t ƒë·ªông qu√©t QR t·ª´ tab Inventory</p>
      </div>
    </div>
  </div>
</div>

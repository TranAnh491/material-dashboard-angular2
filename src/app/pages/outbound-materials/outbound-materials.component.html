<div class="main-content">
  <!-- Excel-like Container -->
  <div class="excel-container">
    <!-- Excel-like Header -->
    <div class="excel-header">
      <h4>üì§ Outbound Materials</h4>
      <p>Qu√©t QR code ƒë·ªÉ xu·∫•t h√†ng t·ª´ kho</p>
    </div>
    
    <!-- QR Code Scanning Section -->
    <div class="qr-scanning-section" *ngIf="!scannedMaterial">
      <div class="scanning-card">
        <div class="scanning-header">
          <h5>
            <i class="material-icons">qr_code_scanner</i>
            Qu√©t QR Code
          </h5>
        </div>
        
        <div class="scanning-content">
          <div class="scanning-area" [class.scanning]="isScanning">
            <i class="material-icons">qr_code</i>
            <p>Nh·∫•n n√∫t "Qu√©t QR Code" ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
          </div>
          
          <div class="scanning-actions">
            <button class="btn btn-primary" (click)="startQRScanning()" [disabled]="isScanning">
              <i class="material-icons">qr_code_scanner</i>
              Qu√©t QR Code
            </button>
            
            <button class="btn btn-secondary" (click)="manualQRInput()">
              <i class="material-icons">input</i>
              Nh·∫≠p th·ªß c√¥ng
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Form Section -->
    <div class="export-form-section" *ngIf="scannedMaterial">
      <div class="export-card">
        <div class="export-header">
          <h5>
            <i class="material-icons">inventory</i>
            Th√¥ng tin h√†ng ƒë√£ qu√©t
          </h5>
        </div>
        
        <div class="export-content">
          <div class="material-info">
            <div class="info-row">
              <span class="label">M√£ h√†ng:</span>
              <span class="value">{{scannedMaterial.materialCode}}</span>
            </div>
            <div class="info-row">
              <span class="label">S·ªë PO:</span>
              <span class="value">{{scannedMaterial.poNumber}}</span>
            </div>
            <div class="info-row">
              <span class="label">S·ªë l∆∞·ª£ng g·ªëc:</span>
              <span class="value">{{scannedMaterial.quantity}}</span>
            </div>
          </div>
          
          <div class="export-form">
            <div class="form-group">
              <label>S·ªë l∆∞·ª£ng xu·∫•t:</label>
              <input type="number" 
                     [(ngModel)]="exportQuantity" 
                     min="1" 
                     max="{{scannedMaterial.quantity}}"
                     class="form-control">
            </div>
            
            <div class="form-group">
              <label>V·ªã tr√≠:</label>
              <input type="text" 
                     [(ngModel)]="exportLocation" 
                     class="form-control"
                     placeholder="Nh·∫≠p v·ªã tr√≠ xu·∫•t">
            </div>
            
            <div class="form-group">
              <label>Ghi ch√∫:</label>
              <textarea [(ngModel)]="exportNotes" 
                        class="form-control"
                        placeholder="Ghi ch√∫ xu·∫•t h√†ng"></textarea>
            </div>
            
            <div class="export-actions">
              <button class="btn btn-success" (click)="exportMaterial()">
                <i class="material-icons">check</i>
                Xu·∫•t h√†ng
              </button>
              
              <button class="btn btn-secondary" (click)="resetExportForm()">
                <i class="material-icons">cancel</i>
                H·ªßy
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Excel-like Actions -->
    <div class="excel-actions">
      <div class="search-box">
        <input type="text" 
               placeholder="T√¨m ki·∫øm..." 
               [(ngModel)]="searchTerm"
               (input)="onSearchChange($event)"
               class="search-input">
      </div>
      
      <div class="date-filters">
        <input type="date" 
               [(ngModel)]="startDate"
               (change)="applyDateRangeFilter()"
               class="date-input">
        <span>ƒë·∫øn</span>
        <input type="date" 
               [(ngModel)]="endDate"
               (change)="applyDateRangeFilter()"
               class="date-input">
      </div>
    </div>

    <!-- Excel-like Body -->
    <div class="excel-body">
      <table class="excel-table">
        <thead>
          <tr>
            <th class="row-header">#</th>
            <th>Ng√†y xu·∫•t</th>
            <th>M√£ h√†ng</th>
            <th>S·ªë P.O</th>
            <th>S·ªë l∆∞·ª£ng g·ªëc</th>
            <th>S·ªë l∆∞·ª£ng xu·∫•t</th>
            <th>V·ªã tr√≠</th>
            <th>Ph∆∞∆°ng th·ª©c</th>
            <th>Ghi ch√∫</th>
            <th>Ng∆∞·ªùi xu·∫•t</th>
            <th>X√≥a</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let material of filteredOutbound; let i = index">
            <td class="row-header">{{i + 1}}</td>
            <td class="date-cell">{{material.exportDate | date:'dd/MM/yyyy HH:mm'}}</td>
            <td class="code-cell">{{material.materialCode}}</td>
            <td>{{material.poNumber}}</td>
            <td class="number-cell">{{material.quantity}}</td>
            <td class="number-cell">{{material.exportQuantity}}</td>
            <td>{{material.location}}</td>
            <td class="method-cell">
              <span class="badge" [class.badge-success]="material.scanMethod === 'QR_SCAN'" 
                    [class.badge-info]="!material.scanMethod || material.scanMethod === 'MANUAL'">
                {{material.scanMethod === 'QR_SCAN' ? 'QR Scan' : 'Manual'}}
              </span>
            </td>
            <td>{{material.notes}}</td>
            <td>{{material.exportedBy}}</td>
            <td class="status-cell">
              <button mat-icon-button color="warn" 
                      matTooltip="X√≥a record n√†y">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- No Data Message -->
      <div class="no-data" *ngIf="filteredOutbound.length === 0">
        <i class="material-icons">inventory_2</i>
        <h5>Ch∆∞a c√≥ record xu·∫•t h√†ng</h5>
        <p>Qu√©t QR code ƒë·ªÉ b·∫Øt ƒë·∫ßu xu·∫•t h√†ng</p>
      </div>
    </div>
  </div>
</div>
